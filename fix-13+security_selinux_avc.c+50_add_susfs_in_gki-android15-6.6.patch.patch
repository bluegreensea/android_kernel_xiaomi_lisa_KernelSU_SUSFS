--- a/50_add_susfs_in_gki-android15-6.6.patch	2025-08-28 22:47:25.723972398 +0800
+++ b/50_add_susfs_in_gki-android15-6.6.patch	2025-08-30 22:44:35.627362489 +0800
@@ -2185,10 +2185,10 @@
  struct avc_entry {
  	u32			ssid;
  	u32			tsid;
-@@ -719,11 +725,23 @@ static void avc_audit_post_callback(struct audit_buffer *ab, void *a)
+@@ -719,13 +725,25 @@ static void avc_audit_post_callback(struct audit_buffer *ab, void *a)
  
- 	rc = security_sid_to_context(sad->tsid, &tcontext,
- 				     &tcontext_len);
+ 	rc = security_sid_to_context(sad->state, sad->tsid, &scontext,
+ 				     &scontext_len);
 +#ifdef CONFIG_KSU_SUSFS
 +	if (unlikely(sad->tsid == susfs_ksu_sid && susfs_is_avc_log_spoofing_enabled)) {
 +	       if (rc)
@@ -2200,12 +2200,14 @@
 +#endif
  	if (rc)
  		audit_log_format(ab, " tsid=%d", sad->tsid);
- 	else
- 		audit_log_format(ab, " tcontext=%s", tcontext);
+ 	else {
+ 		audit_log_format(ab, " tcontext=%s", scontext);
+ 		kfree(scontext);
+ 	}
  
 +#ifdef CONFIG_KSU_SUSFS
 +bypass_orig_flow:
 +#endif
- 	tclass = secclass_map[sad->tclass-1].name;
- 	audit_log_format(ab, " tclass=%s", tclass);
+ 	audit_log_format(ab, " tclass=%s", secclass_map[sad->tclass-1].name);
  
+ 	if (sad->denied)

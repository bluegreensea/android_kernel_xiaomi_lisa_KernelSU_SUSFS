--- a/50_add_susfs_in_gki-android15-6.6.patch	2025-08-28 22:47:25.723972398 +0800
+++ b/50_add_susfs_in_gki-android15-6.6.patch	2025-08-30 22:05:04.148343263 +0800
@@ -1210,17 +1210,17 @@
 --- a/fs/open.c
 +++ b/fs/open.c
 @@ -34,6 +34,9 @@
+ #include <linux/ima.h>
+ #include <linux/dnotify.h>
  #include <linux/compat.h>
- #include <linux/mnt_idmapping.h>
- #include <linux/filelock.h>
 +#ifdef CONFIG_KSU_SUSFS_SUS_SU
 +#include <linux/susfs_def.h>
 +#endif
  
  #include "internal.h"
- #include <trace/hooks/syscall_check.h>
+ 
 @@ -455,6 +458,13 @@ static const struct cred *access_override_creds(void)
- 	return old_cred;
+ 	return ksys_fallocate(fd, mode, offset, len);
  }
  
 +#ifdef CONFIG_KSU_SUSFS_SUS_SU
@@ -1230,9 +1230,9 @@
 +			int *flags);
 +#endif
 +
- static long do_faccessat(int dfd, const char __user *filename, int mode, int flags)
- {
- 	struct path path;
+ /*
+  * access() needs to use the real uid/gid, not the effective uid/gid.
+  * We do this by temporarily clearing all FS-related capabilities and
 @@ -463,6 +473,18 @@ static long do_faccessat(int dfd, const char __user *filename, int mode, int fla
  	unsigned int lookup_flags = LOOKUP_FOLLOW;
  	const struct cred *old_cred = NULL;
